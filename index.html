<!DOCTYPE html>
<html>
<body>
<h2>Quiz Game</h2>
<div id="player-name">
  <input id="name" placeholder="Enter your name" />
  <button id="join">Join Quiz</button>
</div>
<div id="quiz" style="display:none">
  <div id="question"></div>
  <div id="options"></div>
</div>
<h3>Leaderboard</h3>
<div id="leaderboard"></div>

<script>
const ws = new WebSocket("wss://quiz-web-backend.onrender.com");

document.getElementById("join").onclick = () => {
  const name = document.getElementById("name").value || "Anonymous";
  ws.send(JSON.stringify({ type: "NAME", name }));
  document.getElementById("player-name").style.display = "none";
  document.getElementById("quiz").style.display = "block";
};

ws.onmessage = function(event) {
  const data = JSON.parse(event.data);

  if (data.type === "QUESTION") {
    document.getElementById("question").innerText = data.text;
    const optionsDiv = document.getElementById("options");
    optionsDiv.innerHTML = "";
    data.options.forEach(opt => {
      const btn = document.createElement("button");
      btn.innerText = opt;
      btn.onclick = () => ws.send(JSON.stringify({ type: "ANSWER", answer: opt[0] }));
      optionsDiv.appendChild(btn);
    });
  }

  if (data.type === "GAMEOVER") {
    document.getElementById("question").innerText = "Game Over!";
    document.getElementById("options").innerHTML = "";
    updateLeaderboard(data.leaderboard);
  }
};

function updateLeaderboard(players) {
  const lb = document.getElementById("leaderboard");
  lb.innerHTML = "";
  players.forEach(p => {
    const div = document.createElement("div");
    div.innerText = `${p.name}: ${p.score}`;
    lb.appendChild(div);
  });
}
</script>
</body>
</html>
